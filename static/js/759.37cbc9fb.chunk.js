"use strict";(self.webpackChunkdevblog=self.webpackChunkdevblog||[]).push([[759],{6674:function(e,n,r){r.d(n,{c:function(){return o}});var t=r(9737),i=r(184);function o(e){var n=(0,t.b)({text:e,speed:1,overdrive:!1,scramble:10}),r=n.ref,o=n.replay;return(0,i.jsx)("h1",{className:"scrambled",ref:r,onClick:o})}},3759:function(e,n,r){r.r(n);var t=r(5671),i=r(9466),o=r(136),a=r(516),s=(r(697),r(206),r(2791)),c=r(6674),l=r(2407),u=r(7900),h=r(184),d=function(e){(0,o.Z)(r,e);var n=(0,a.Z)(r);function r(){return(0,t.Z)(this,r),n.apply(this,arguments)}return(0,i.Z)(r,[{key:"render",value:function(){return(0,h.jsx)("pre",{children:(0,h.jsx)("code",{className:"language-python",children:'\n    # Maintainer: Vasya Pupkin <dvorak.dwarf@gmail.com>\n    pkgname=fauxnix-git\n    pkgver=r64.cff5977\n    pkgrel=1\n    pkgdesc="Non-invasive* Reproducible* Declarative* config management for Nix non-believers"\n    arch=(\'any\')\n    url="https://github.com/DvorakDwarf/fauxnix"\n    license=(\'GPL3\')\n    depends=(python pacman python-ruamel-yaml)\n    makedepends=(git python-setuptools  python-build python-wheel python-installer)\n    provides=(\'fauxnix\')\n    conflicts=(\'fauxnix\')\n    source=("$pkgname::git+https://github.com/DvorakDwarf/fauxnix.git")\n    md5sums=(\'SKIP\')\n\n    pkgver() {\n      cd "$pkgname"\n      printf "r%s.%s" "$(git rev-list --count HEAD)" "$(git rev-parse --short=7 HEAD)"\n    }\n\n    build() {\n      cd "$pkgname"\n\n      python -m build --wheel --no-isolation\n    }\n\n    package() {\n      cd "$pkgname"\n\n      install -Dm644 src/fauxnix/fauxnix.yaml "$pkgdir/etc/fauxnix.yaml"\n      install -Dm644 LICENSE $pkgdir/usr/share/licenses/$pkgname/LICENSE\n      install -Dm644 README.md $pkgdir/usr/share/doc/$pkgname/README.md\n      install -Dm755 src/fauxnix.hook $pkgdir/usr/share/libalpm/hooks/fauxnix.hook\n\n      python -m installer --destdir="$pkgdir" dist/*.whl\n    }\n  '})})}}]),r}(s.Component);n.default=function(){var e=r(3011),n=new Date(e.date).toLocaleDateString("en-us",{year:"numeric",month:"short",day:"2-digit"});return(0,h.jsxs)("div",{className:"PKGBUILD",children:[(0,h.jsx)(l.Z,{}),(0,h.jsxs)("article",{children:[(0,h.jsxs)("div",{className:"cover",children:[(0,c.c)(e.title),(0,h.jsx)("time",{children:n}),(0,h.jsx)("img",{className:"thumbnail",src:r(3084)}),(0,h.jsx)("hr",{})]}),(0,h.jsxs)("main",{children:[(0,h.jsxs)("p",{children:[(0,h.jsx)("h2",{children:"Preface on getting help."})," ",(0,h.jsx)("br",{}),"If you find yourself using any of the following phrases or types of replies:",(0,h.jsxs)("ul",{children:[(0,h.jsx)("li",{children:'"Help vampire"'}),(0,h.jsx)("li",{children:'"RTFM"'}),(0,h.jsx)("li",{children:"(link to a wiki article with no further explanation)"}),(0,h.jsx)("li",{children:"(a command meant to solve the issue with no comment on how it works)"}),(0,h.jsx)("li",{children:'"Read the docs"'})]}),"Know that every breath you take is a net negative impact on the planet. You replying with nothing at all would have been a better use of everybody's time."]}),(0,h.jsx)("h2",{children:"What the PKGBUILD does"}),(0,h.jsxs)("p",{children:["First, you need to understand what the PKGBUILD actually does. The way it works is it opens a directory ",(0,h.jsx)("code",{children:"pkg"})," in the same directory you used the file. Every file your program uses will first be placed there, ",(0,h.jsx)("b",{children:"NOT THE SYSTEM"}),". That is why you must include ",(0,h.jsx)("code",{children:"$pkgdir"})," in your paths. Once the PKGBUILD ends, pacman will look at the folder and copy the files into paths with the same name.",(0,h.jsx)("code",{children:" $pkgdir/usr/bin/yourprogram"})," goes into ",(0,h.jsx)("code",{children:"/usr/bin/yourprogram "}),"on the system. (You might need curly brackets around the pkgdir and pkgname variables)"]}),(0,h.jsx)("h2",{children:"The crucial details"}),(0,h.jsx)(d,{}),(0,h.jsxs)("p",{children:["Variables you must have:",(0,h.jsx)("br",{}),(0,h.jsxs)("ul",{children:[(0,h.jsx)("li",{children:"pkgname: The name. Needs -git ending if taken from the git repo, -bin if installing binaries and not building, start with python- if it's a python library (not app)"}),(0,h.jsx)("li",{children:"pkgver: The version. If using git, set in pkgver() function"}),(0,h.jsx)("li",{children:"pkgrel: If you needed it you'd know. 1 by default. Increment if the same version has an update"}),(0,h.jsx)("li",{children:"arch: Architecture your software works on. 'any' for python since it's cross-platform"}),(0,h.jsx)("li",{children:"license: Name of license. 'MIT', 'GPL', and so on"})]}),"Variables you probably need: ",(0,h.jsx)("br",{}),(0,h.jsxs)("ul",{children:[(0,h.jsx)("li",{children:"pkgdesc: A description of your package. 80 characters or less. Do not reference the name of the package"}),(0,h.jsx)("li",{children:"url: Your official site. Likely a github repo"}),(0,h.jsx)("li",{children:"depends: Packages your software uses. Python libraries used included"}),(0,h.jsx)("li",{children:"makedepends: Packages only required to build the package, not for functionality."}),(0,h.jsx)("li",{children:"provides/conflicts: The name of packages your package provides the function for. Basically means that if you have a git package, put the name without git here to make sure you can't install both if you ever make one in the future"}),(0,h.jsx)("li",{children:"source: The URL from which the files required for your package would be downloaded from. In the case of git, put git+ before the URL normally used to clone the repo"}),(0,h.jsx)("li",{children:"md5sums: Verify integrity with md5. 'SKIP' if using git"})]}),"Functions you likely need: ",(0,h.jsx)("br",{}),(0,h.jsxs)("ul",{children:[(0,h.jsxs)("li",{children:["pkgver(): If you are using git, set the version this way. Copy one from ",(0,h.jsx)("a",{href:"https://wiki.archlinux.org/title/VCS_package_guidelines#Git",children:"arch wiki"})]}),(0,h.jsxs)("li",{children:["build(): Build package here. ",(0,h.jsx)("code",{children:"python -m build --wheel --no-isolation"})]}),(0,h.jsx)("li",{children:"package(): Shuffle all the files into the correct place here for pacman. Use the install script to set permissions. 644 for reading and 755 for execution. Follow my PKGBUILD above for paths where files are to be placed. Here you also run python -m installer"})]})]}),(0,h.jsx)("h2",{children:"Note on setup.py"}),(0,h.jsxs)("p",{children:["You should avoid using it. For the build step of your python project, you need",(0,h.jsx)("code",{children:" pyproject.toml"})," file to describe how your program ought to be built. It was a replacement for setup.py. It has the same features and more. Use python -m installer to make use of it. I was shown python -m install . which seems to do the same thing but is less popular and allows you to still use setup.py without explicitly calling it. I would still recommend avoiding it."]})]})]}),(0,h.jsx)(u.Z,{})]})}},9737:function(e,n,r){r.d(n,{b:function(){return a}});var t=r(2791);function i(e,n){return Math.floor(Math.random()*(n-e+1))+e}function o(e){var n=0;return n=2===e.length?i(e[0],e[1]):e[i(0,e.length-1)],String.fromCharCode(n)}var a=function(e){var n=e.playOnMount,r=void 0===n||n,a=e.text,s=void 0===a?"":a,c=e.speed,l=void 0===c?1:c,u=e.seed,h=void 0===u?1:u,d=e.step,p=void 0===d?1:d,f=e.tick,m=void 0===f?1:f,g=e.scramble,y=void 0===g?1:g,x=e.chance,k=void 0===x?1:x,v=e.overflow,b=void 0===v||v,j=e.range,w=void 0===j?[65,125]:j,D=e.overdrive,I=void 0===D||D,A=e.onAnimationStart,E=e.onAnimationFrame,L=e.onAnimationEnd,P=e.ignore,$=void 0===P?[" "]:P;"undefined"!==typeof window&&window.matchMedia("(prefers-reduced-motion: reduce)").matches&&(p=s.length,k=0,I=!1);var F=(0,t.useRef)(null),N=(0,t.useRef)(0),R=(0,t.useRef)(0),T=1e3/(60*l),M=(0,t.useRef)(0),S=(0,t.useRef)(0),C=(0,t.useRef)([]),U=(0,t.useRef)(0),G=function(e,n){return $.includes(""+e)?e:n},K=function(){!function(){for(var e=0;e<p;e++)if(S.current<s.length){var n=S.current,r=i(0,10)>=10*(1-k);C.current[n]=G(s[S.current],r?y+i(0,Math.ceil(y/2)):0),S.current++}}(),function(){s.length<C.current.length&&(C.current.pop(),C.current.splice(s.length,p));for(var e=0;e<p;e++)C.current.length<s.length&&C.current.push(G(s[C.current.length+1],null))}(),function(){if(S.current!==s.length)for(var e=0;e<h;e++){var n=i(S.current,C.current.length);"number"!==typeof C.current[n]&&"undefined"!==typeof C.current[n]&&(C.current[n]=G(C.current[n],i(0,10)>=10*(1-k)?y||h:0))}}()},B=function e(n){l&&(N.current=requestAnimationFrame(e),function(){if(I)for(var e=0;e<p;e++){var n=Math.max(C.current.length,s.length);U.current<n&&(C.current[U.current]=G(s[U.current],String.fromCharCode("boolean"===typeof I?95:I)),U.current++)}}(),n-R.current>T&&(R.current=n,M.current%m===0&&K(),Z()))},Z=function(){if(F.current){for(var e="",n=0;n<C.current.length;n++){var r=C.current[n];switch(!0){case"number"===typeof r&&r>0:e+=o(w),n<=S.current&&(C.current[n]=C.current[n]-1);break;case"string"===typeof r&&(n>=s.length||n>=S.current):e+=r;break;case r===s[n]&&n<S.current:e+=s[n];break;case 0===r&&n<s.length:e+=s[n],C.current[n]=s[n];break;default:e+=""}}F.current.innerHTML=e,E&&E(e),e===s&&(C.current.splice(s.length,C.current.length),L&&L(),cancelAnimationFrame(N.current)),M.current++}},H=function(){M.current=0,S.current=0,U.current=0,b||(C.current=new Array(null==s?void 0:s.length))};return(0,t.useEffect)((function(){H()}),[s]),(0,t.useEffect)((function(){return cancelAnimationFrame(N.current),N.current=requestAnimationFrame(B),function(){cancelAnimationFrame(N.current)}}),[B]),(0,t.useEffect)((function(){r||(C.current=s.split(""),M.current=s.length,S.current=s.length,U.current=s.length,Z(),cancelAnimationFrame(N.current))}),[]),{ref:F,replay:function(){cancelAnimationFrame(N.current),H(),A&&A(),N.current=requestAnimationFrame(B)}}}},206:function(){},697:function(){},3084:function(e,n,r){e.exports=r.p+"static/media/pkglogo.7fb23a7c1d5e7314af02.jpg"},3011:function(e){e.exports=JSON.parse('{"date":"2023-11-22T03:11:59.857Z","slug":"how-to-pkgbuild","title":"Writing PKGBUILD for a python app with vcs"}')}}]);
//# sourceMappingURL=759.37cbc9fb.chunk.js.map